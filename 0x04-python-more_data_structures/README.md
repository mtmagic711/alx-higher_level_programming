Pthin with more data structures.
